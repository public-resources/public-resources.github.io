(function(){function e(){function e(){if("undefined"!=typeof jwplayer){if(P=jwplayer("tplayer"),j=window.location.protocol,B=!0,V=!1,P.utils.isAndroid()){var e=k();e&&parseInt(e,10)<5?(H=!1,j="http:",R=0,V=!0):B=!1}else/PlayStation/i.test(navigator.userAgent)&&(H=!1,j="http:",R=0);T=P.utils.isMobile(),x=P.utils.isSafari(),D.monitor=D._monitor,l.sendSt("0|player init")}}function t(){G||(G=!0,P.once("bufferChange",function(){P.pause(),P.pause(),G=!1}))}function n(e){return P.load(e)}function r(e){n(e).play()}function c(){var e,t={kind:"thumbnails",file:p()};return e=1==_app.video.subs?[t,{file:u(),kind:"captions",label:"English"}]:[t],e}function p(){return _app.datadomain+s.th+"?v="+_app.video.id+"&ct="+_app.video.vct}function u(){return _app.data.sdm?"//cname.cf/html/subs/"+_app.video.eid+".vtt?ct=sub_"+_app.video.vct:s.cdn+"subs/"+_app.video.eid+".vtt"}function h(e,t,a,i){var o=_app.video.imageurl,s=c();P.setup({file:e,type:"hls",hlsjsdefault:H,image:o,tracks:s,autostart:t,mute:a,width:"100%",preload:"none",captions:l.captStyle,skin:l.pSkin,playbackRateControls:[.25,.5,.75,1,1.25,1.5,2],ga:{}}),y(),i&&(P.once("time",function(){P.seek(i)}),P.once("pause",function(e){"external"===e.pauseReason&&P.seek(i)}),P.once("seeked",function(){P.getPosition()<1&&P.seek(i)})),q=!0,L=B?r:n}function f(){var e=/(\?|&)t=(\d+)/.exec(window.location.search);return e?e[2]:null}function v(){var e=$("#tplayer .jw-rightclick ul");e.empty().append($('<li class="jw-reset jw-menuitem">Capture screenshot</li>').click(function(){var e=m(),t="";if(e){var n=P.getPosition()/60;t=" ("+parseInt(n)+":"+Math.round(n%1*60)+";"+_app.video.ecode+";"+P.getVisualQuality().level.height+"p)",l.sendSt("0|take scr"+t)}else setTimeout(function(){alert("Play the video first"),l.sendSt("0|take scr")},50)})).append($('<li class="jw-reset jw-menuitem">Copy video URL at current time</li>').click(function(){var e=this.parentElement.parentElement,t=Math.round(P.getPosition()),n="";t>0&&(n="&t="+t),g("https://watchtlg.netlify.com/watch?v="+_app.video.id+n,e),l.sendSt("0|copy url: "+_app.video.id+n)}))}function m(){function e(e){function n(){var e=_app.video.title.replace(/\s/g,"_").replace(/\!|\?/g,""),n=new Date(1e3*t.currentTime).toISOString().substring(12,23).replace(/:/g,".");return"The_Lion_Guard_"+e+"_WatchTLG_snapshot_"+n+"_"+P.getVisualQuality().level.height+"p"}var a,i=(a=document.createElement("a"),function(e,t){if(window.navigator&&window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,t);else{var n=URL.createObjectURL(e);a.href=n,a.download=t,document.body.appendChild(a),a.click(),setTimeout(function(){document.body.removeChild(a),window.URL.revokeObjectURL(n)},100)}});i(e,n()+".png")}if("idle"===P.getState())return!1;var t=document.getElementById("tplayer").querySelector("video"),n=document.createElement("canvas");n.width=t.videoWidth,n.height=t.videoHeight;var a=n.getContext("2d");return a.drawImage(t,0,0,n.width,n.height),n.toBlob(function(t){e(t)},"image/png"),!0}function g(e,t){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var n=document.createElement("textarea");n.textContent=e,n.style.position="fixed",t.style.display="block",t.appendChild(n),n.select();try{return document.execCommand("copy")}catch(e){return console.warn("Copy to clipboard failed.",e),!1}finally{t.removeChild(n),t.style=""}}}function y(){_app.data.isbot||(P.on("error",function(e){var t="",n="";if(E(e.message,"Flash")||A(e.message),a)try{a.length>2&&(t=a[2].url,n=" ("+t.replace(/.*\/stream\//,"../")+")",t=" - "+t)}catch(e){}l.sendSt("-1|player error: "+_app.video.ecode+": "+e.message+n+" ("+P.getProvider().name+")"),ga("send","event","JW Player","Error",e.message+t)}),t(),P.on("playlistItem",function(){Q()}),P.on("playlistComplete",function(){t()}),P.on("ready",function(){v(),-1===P.getProvider().name.indexOf("flash")&&(U=function(){setTimeout(_,1e3)})}),P.on("captionsList",function(e){if(F(e.tracks),"idle"!==P.getState()){var t=e.tracks,n=t.length-1;0!==n&&(S(e.track),x||(1==_app.video.subs?(/^(?:(?:\/\/)|(?:blob)|(?:http))/.test(t[n].id)||w(n),t.length>1&&U()):3===t.length&&(P.off("captionsList"),t[1].label===t[2].label?w(2):"Unknown CC"===t[2].label&&setTimeout(function(){var e=document.querySelector(".jw-icon-cc .jw-menu");e.querySelector(".jw-option.jw-item-2").textContent=e.querySelector(".jw-option.jw-item-1").textContent,w(1)},100))))}}),P.on("levelsChanged",function(e){l.sendSt("1b|"+e.levels[e.currentQuality].label.toLowerCase())}),P.once("visualQuality",function(e){"auto"===e.mode?l.sendSt("1a|auto"):l.sendSt("1a|"+e.level.label),!0}),P.on("captionsChanged",function(e){if(!D.disablelog&&D.selected!==e.track){if(0===e.track)D.selected=e.track,l.sendSt("2b|disabled"),ga("send","event","JW Player Video","Captions disabled");else{var t=e.tracks[e.track],n=O[t.id],a="";D.selected=e.track,void 0!==n&&(a=" "+n),l.sendSt("2b|enabled"+a),ga("send","event","JW Player Video","Captions enabled",t.label)}D.monitor()}}),P.on("playbackRateChanged",function(e){var t=P.getPosition()/60;l.sendSt("3b|"+e.playbackRate+" ("+parseInt(t)+":"+Math.round(t%1*60)+";"+_app.video.ecode+")")}))}function w(e){l.createClass(".jw-icon-cc .jw-menu .jw-option.jw-item-"+e,"display: none")}function _(){var e=document.querySelector("#tplayer .jw-controls .jw-icon-cc ul");if(e&&!document.getElementById("cc_tr")){var t="ontouchend"in window?"ontouchend":"onclick",n=document.createElement("li");n.setAttribute("class","jw-text jw-option jw-reset"),n.setAttribute("id","cc_tr"),n.appendChild(document.createTextNode("Auto-translate (beta)")),n[t]=function(){z(t)},e.appendChild(n)}}function b(e){function t(){for(var e=i.firstChild;e;)i.removeChild(e),e=parent.firstChild;i.parentElement.removeChild(i),Q=M,z=b}function n(){var e=document.createElement("span");e.appendChild(document.createTextNode("Translator load error")),a.style.display="none",d.style.display="none",msg.appendChild(e),l.sendSt("-1|translator load error")}var a=document.createElement("iframe"),i=document.createElement("div"),o=document.createElement("header"),r=document.createElement("span"),s=document.createElement("h3"),d=document.createElement("div");msg=document.createElement("div"),fa=document.createElement("i"),tt=document.createElement("span"),i.setAttribute("class","p-dialog"),d.setAttribute("class","spinner"),d.style.cssText="margin: .8em 2em",r.setAttribute("class","close"),msg.setAttribute("class","dialog-body"),fa.setAttribute("class","fa fa-info-circle"),tt.setAttribute("class","tooltip"),s.appendChild(document.createTextNode("Auto-translate")),r.appendChild(document.createTextNode("×")),r[e]=t,fa[e]=function(){this.firstChild.className+=" disp",this[e]=null},tt.appendChild(document.createTextNode("Auto-translate is currently not available on Safari browsers.")),fa.appendChild(tt),o.appendChild(s),o.appendChild(r),o.appendChild(fa),msg.appendChild(d),msg.appendChild(a),i.appendChild(o),i.appendChild(msg),a.src="/sub/translate.html",a.width="100%",a.height="100%",a.scrolling="no",a.style.visibility="hidden",a.onload=function(){try{a.contentWindow._tready||n()}catch(e){n()}},a.setAttribute("frameborder","0"),document.getElementById("tplayer").appendChild(i),window._atready=function(){a.style.visibility="",d.style.display="none"},window._atfinished=function(e,n,a){F=function(e){t(),P.setCurrentCaptions(e.length-1),F=M},O[e]=a,P.addTextTrack([{kind:"captions",file:e,label:n+" (auto-translated)"}]),l.sendSt("5|"+n),ga("send","event","JW Player Video","Translate captions",n)},window._atlog=function(e){l.sendSt(e)},z=M,Q=t,l.sendSt("0|translate click")}function S(e){W||(0!==e&&(l.sendSt("2a|enabled"),ga("send","event","JW Player Video","Captions enabled",P.getCaptionsList()[e].label)),W=!0,D.selected=e)}function C(){function e(){if(P.getPosition()>0){var e=P.getVisualQuality();if(e)return e.level.height}return null}function t(e){return{action:e,playUrl:i.getQueryR(!1),captionsUrl:1==_app.video.subs?u():null,thumbsUrl:p(),poster:_app.video.imageurl}}function n(){a.setAttribute("height",a.contentWindow.document.body.firstElementChild.clientHeight+"px"),a.contentWindow.document.body.firstElementChild.clientHeight}var a,r=P.utils.isMobile(),s=P.getPosition(),c=e(),h=!1;jwplayer().remove(),d.vcontainer.removeChild(document.getElementById("tplayer")),a=document.createElement("iframe"),a.src="/aplayer.html",a.width="100%",a.height="100%",a.setAttribute("id","tplayer"),a.setAttribute("class","invisible"),a.setAttribute("frameborder","0"),a.setAttribute("allowfullscreen",""),a.onload=function(){function e(){h=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen}var i=t("init");i.datadomain=_app.datadomain,i.videoQuality=c,i.videoPosition=s-3,i.isMobile=r,a.contentWindow.postMessage(i,"*"),a.contentWindow.addEventListener("resize",function(){h||n()}),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),n(),$("#tplayer").removeClass("invisible"),l.showPlayer()},d.vcontainer.insertBefore(a,d.vcontainer.firstChild),$(d.valertp).text(""),$(d.valertload).show(),$(d.valert).show(),o.play=function(){a.contentWindow.postMessage(t("play"),"*")},o.prepare=function(){a.contentWindow.postMessage(t("prepare"),"*")},o.pause=function(){a.contentWindow.postMessage({action:"pause"},"*")},o.reset=function(){a.contentWindow.postMessage({action:"stop"},"*")}}function k(){var e=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return!!e&&e[1]}function A(e){var t=P.getPosition().toFixed(2);$("#ntf").empty().append(document.createTextNode("Something went wrong...")).append($("<br>")).append($('<div class="nft-btn"><i class="fa fa-refresh" aria-hidden="true"></i>&nbsp;Reload</div>').click(function(){o.reload(),t>3&&P.once("time",function(){P.seek(t-3)}),l.hideNtf(),l.sendSt("-1|reload player (pos: "+t+"; e: "+e+")")})).append($('<div class="nft-btn"><i class="fa fa-exchange" aria-hidden="true"></i>&nbsp;Change player</div>').click(function(){C(),l.hideNtf(),l.sendSt("-1|switch player (pos: "+t+"; e: "+e+")")})).append($('<span class="close">×</span>').click(function(){l.hideNtf()})).show()}function E(e,t){return-1!==e.indexOf(t)}var P,j,x,T,V,B,L,R=1,N=0,I=!1,q=!1,W=!1,H=!0,G=!1,M=function(){},D={selected:-1,selectCount:0,disablelog:!1,monitor:M,_reset:function(){D.selectCount=0},_monitor:function(){D.selectCount++,D.selectCount>3&&(D.disablelog=!0),clearTimeout(D._timeout),D._timeout=setTimeout(D._reset,3e3)},_timeout:null},F=M,Q=M,U=M,z=b,O={};this.sp=function(){return j},this.p=function(){return N},this.s=function(){return R},e(),this.reset=function(){P.stop()},this.pause=function(){P.play(!1)},this.prepare=function(e){var t=!1,n=!1,a=f();a&&(t=e,n=T&&!V),h(i.getQueryR(!1),t,n,a)},this.play=function(){var e=j+_app.datadomain+s.str+_app.video.query,n=_app.video.imageurl,a=c();D.selected=-1,O={},q&&!I?(t(),L([{file:e,type:"hls",image:n,tracks:a}])):(q&&(P.remove(),q=!1),h(e,B,!1,null))},this.reload=function(){var e;P.getPlaylistItem();e=i.getQueryR(!0),P.load([{file:e,type:"hls",image:_app.video.imageurl,tracks:c()}]).play()}}function t(e){var t=_app.data.sessid;this.getQuery=function(e){function n(){$.ajax({type:"POST",url:i(),data:r(),dataType:"json",timeout:p,success:a,error:function(e){c?(ga("send","event","General","Server error","Status code: "+e.status+"; url: "+this.url),$(d.valertload).hide(),alert("A connection error occurred. Please refresh the page and try again.")):(c=!0,p=0,n(),ga("send","event","General","Retry","Status code: "+e.status+"; url: "+this.url))}})}function a(t){if(0==t.error)_app.video.query=t.eid+".m3u8?"+t.query,e();else{var n=History.getState();1==t.error?n.data.online=0:3==t.error&&(n.data.error=1),History.replaceState(n.data,n.title,n.url),l.clearVAlertBcg(),l.showVAlert(t.msg)}}function i(){return _app.datadomain+s.auth}function r(){return"video_id="+_app.video.id+"&p="+o.p()+"&s="+o.s()+"&session="+t}var c=!1,p=7e3;n()},this.getQueryR=function(e){var n="0";return e&&(n="1"),_app.datadomain+s.auth+"?"+Base64.encode(o.p()+"|"+o.sp()+_app.datadomain+s.str+"|"+t+"|"+_app.video.id+"|"+n+"|"+Date.now())},this.get=function(){return t}}function n(){var e=History.getState().data;l.sendSt("0|popstate"),o.reset(),l.hideNtf(),e.id?(_app.video=e,l.unsetPlaying(),l.setPlaying(_app.video.cid),l.showVideo(function(){l.showPlayer(),o.prepare(!1)}),_app.disqus.load()):(l.showHome(),l.unsetPlaying(),_app.video.cid=null,_app.disqus.remove())}window.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_,",encode:function(e){var t,n,a,i,o,r,s,d="",l=0;for(e=Base64._utf8_encode(e);l<e.length;)t=e.charCodeAt(l++),n=e.charCodeAt(l++),a=e.charCodeAt(l++),i=t>>2,o=(3&t)<<4|n>>4,r=(15&n)<<2|a>>6,s=63&a,isNaN(n)?r=s=64:isNaN(a)&&(s=64),d=d+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(r)+this._keyStr.charAt(s);return d},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t}};var a,i=null,o=null,r=0,s={sh:"sh552533522/",cont:"content.json",str:"stream/",th:"stream/thumbs.vtt",sess:"auth/session",auth:"auth/authorize",vid:"videos.json",cdn:"//public-resources.github.io/"},d={home:document.getElementById("main-poster"),content:document.getElementById("content"),vdetails:document.getElementById("v-details"),vcontainer:document.getElementById("videocontainer"),vtitle:document.querySelector("#v-details .video-title"),vdesc:document.querySelector("#v-details .video-description"),valert:document.getElementById("v-alert"),valertp:document.querySelector("#v-alert p"),valertload:document.querySelector("#v-alert .player-loader"),playing:'<div class="play" title="Now Playing"></div>',ploader:'<div class="player-loader centered"><span></span><span></span><span></span></div>'},l={pVisible:!1,captStyle:{color:"#FFFFFF",fontFamily:"Roboto,Arial,Helvetica,sans-serif",backgroundOpacity:65,fontSize:12},pSkin:{url:s.cdn+"lib/jwplayer/7.12.13_4/build.css",name:"custom"},createClass:function(e,t){var n=document.createElement("style");n.type="text/css",document.head.appendChild(n),(n.sheet||{}).insertRule?n.sheet.insertRule(e+"{"+t+"}",0):(n.styleSheet||n.sheet).addRule(e,t)},unsetPlaying:function(){var e=$("ul.section-contents").children("li.cell.playing");if(e.length>0){var t=e.find("a");t.attr("href","/watch?v="+t.attr("data-id")),e.removeClass("playing"),e.children("div.player-loader").remove(),e.children("div.play").remove()}},setPlaying:function(e){if(e){var t=$("#"+e);t.length>0&&(t.find("a").removeAttr("href"),t.addClass("playing"),t.children("div.player-loader").remove(),t.append(d.playing))}},setLoading:function(e){this.unsetPlaying();var t=$("#"+e);t.find("a").removeAttr("href"),t.addClass("playing"),t.append(d.ploader)},sendSt:function(e){if(e.length>180){var t="(1/2)",n="(2/2)",a=180-t.length,i=t+e.substring(0,a),o=n+e.substring(a);l.sendStR(Base64.encode(i)),l.sendStR(Base64.encode(o))}else l.sendStR(Base64.encode(e))},sendStR:function(e){var t=new XMLHttpRequest;t.open("GET",_app.datadomain+"ws/t?"+e,!0),t.send()},showPlayer:function(){$(d.valert).hide(),$(d.home).hide(),$("#tplayer").show()},showVideo:function(e){1==_app.video.error?($(d.vdetails).hide(),this.clearVAlertBcg(),this.showVAlert("Video not found"),o.reset()):1==_app.video.online?(this.showVDetails(),e()):(this.showVDetails(),_app.video.msg?this.showVAlertBcg(_app.video.msg):this.showVAlertBcg("Sorry, this video is currently unavailable"),o.reset())},hideNtf:function(){$("#ntf").empty().hide()},hidePlayer:function(){$("#tplayer").hide()},showHome:function(){this.hidePlayer(),$(d.valert).hide(),$(d.vdetails).hide(),$(d.home).show()},showVDetails:function(){if(1==_app.video.special)d.vtitle.innerHTML=_app.video.title;else{var e="";1==_app.video.is_double&&(e='<span class="sep">-</span><span>Season '+_app.video.seasonnumber+" Episode "+(parseInt(_app.video.episodenumber)+1)+"</span>"),d.vtitle.innerHTML="<span>Season "+_app.video.seasonnumber+" Episode "+_app.video.episodenumber+"</span>"+e+"<br>"+_app.video.title}$(d.vdesc).text(_app.video.description),$(d.vdetails).show()},showVAlert:function(e){this.hidePlayer(),$(d.home).hide(),void 0===e?($(d.valertp).html(""),$(d.valertload).show()):($(d.valertload).hide(),$(d.valertp).html(e)),$(d.valert).show()},showVAlertBcg:function(e){$(d.valert).find(".poster-offline").css("background","url("+_app.video.imageurl+") black"),this.showVAlert(e)},clearVAlertBcg:function(){$(d.valert).find(".poster-offline").css("background","")}};(function(){function n(e,t){t.insertAdjacentHTML("beforebegin",e),l.setPlaying(_app.video.cid)}function a(e,t){function n(){$.ajax({type:"GET",url:c(),dataType:"json",timeout:u,success:a,error:function(e){p?(l.unsetPlaying(),ga("send","event","General","Server error","Status code: "+e.status+"; url: "+this.url),_app.datadomain==_app.datadomain2?(_app.datadomain=_app.datadomain1,ga("send","event","General","Server error 2","Status code: "+e.status+"; url: "+this.url),alert("A connection error occurred. Please try again.")):(_app.datadomain=_app.datadomain2,n(),ga("send","event","General","Change datadomain","Status code: "+e.status+"; url: "+this.url))):(p=!0,u=0,n(),ga("send","event","General","Retry","Status code: "+e.status+"; url: "+this.url))}})}function a(n){for(var a in t(n.online),window.location.hash&&History.replaceState(_app.video,document.title,window.location.pathname+window.location.search),_app.video.id=e,n)_app.video[a]=n[a];l.showVideo(function(){l.showVAlert(),i.getQuery(function(){l.showPlayer(),o.play()})}),l.hideNtf(),window.innerWidth>window.innerHeight&&window.innerWidth<1100?d.vcontainer.scrollIntoView():scroll(0,0),History.pushState(_app.video,r(),"/watch?v="+_app.video.id),_app.disqus.load()}function c(){return _app.datadomain+s.sh+s.vid+"?v="+e}var p=!1,u=0;n()}function r(){if(1==_app.video.special)return"The Lion Guard: "+_app.video.title+" | WatchTLG";var e="";return 1==_app.video.is_double&&(e="-E"+(parseInt(_app.video.episodenumber)+1)),"The Lion Guard S"+_app.video.seasonnumber+" E"+_app.video.episodenumber+e+": "+_app.video.title+" | WatchTLG"}function c(e,t,a,i,o,r){$.get(p(e,t,a),function(e,t){n(e.html,i),o(1==e.next)},"json").fail(function(e){r(),alert("Failed to load data. Please try again."),ga("send","event","General","Server error","Status code: "+e.status+"; url: "+this.url)})}function p(e,t,n){return _app.datadomain+s.sh+s.cont+"?s="+e+"&start="+t+"&size="+n+"&ct="+_app.data.cachetag}if($(d.content).on("click",".playable:not(.playing)",function(e){e.preventDefault();var t=$(this),n=t.find("a").attr("data-id"),i=this.id,r=t.hasClass("down");l.sendSt("0|click "+i),l.setLoading(i),o.pause(),a(n,function(e){_app.video.cid=i,l.setPlaying(i),r&&"1"==e&&(t.removeClass("down"),t[0].removeChild(t[0].getElementsByClassName("down-info")[0]))})}),function(){for(var e=d.content.querySelectorAll(".cell.more"),t=0,n=e.length;t<n;t++)(function(e){function t(t){t.preventDefault(),c(this.getAttribute("data-id"),i,o,this,n,a),e.onclick=function(e){e.preventDefault()},e.children[1].className="expand loading",$(e).append(d.ploader),l.sendSt("0|load more")}function n(n){i+=o,n?(e.onclick=t,e.children[1].className="expand",$(e).children("div.player-loader").remove()):e.parentNode.removeChild(e)}function a(){e.onclick=t,e.children[1].className="expand",$(e).children("div.player-loader").remove()}var i=parseInt(e.getAttribute("data-offset")),o=parseInt(e.getAttribute("data-size"));e.onclick=t})(e[t])}(),o=new e,i=new t,_app.video.id)if(_app.video.cid="cell_"+_app.video.ecode,_app.data.isbot)l.showVideo(function(){o.prepare(!1),l.showPlayer()});else{var u=window.location.hash,h=window.location.search.replace(/&s=\w+/,"");History.replaceState(_app.video,document.title,window.location.pathname+h+u),0==_app.video.error&&(l.setPlaying(_app.video.cid),_app.disqus.load()),l.showVideo(function(){o.prepare(!0),l.showPlayer()})}else History.replaceState(null,document.title,window.location.pathname+window.location.search+window.location.hash)})(),History.Adapter.bind(window,"statechange",n),window.onerror=function(e,t,n){return r<5&&(l.sendSt("-1|"+e+":"+n),r++),!1},console.defaultError=console.error.bind(console),console.error=function(){console.defaultError.apply(console,arguments),a=arguments}})();
